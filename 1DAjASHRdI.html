<!doctype html>
<html lang="en">
<head>
<title>1DAjASHRdI</title>
<meta charset="utf-8">
<style> * { font-family: arial, sans-serif;
font-size: 13px;
line-height: 17px; }ul.indent { list-style-type: none; }ol { list-style-type: none; padding-left:0;}body > ol { counter-reset: first second third fourth fifth sixth seventh eigth ninth tenth eleventh twelth thirteenth fourteenth fifteenth sixteenth; }ol > li:before {content: counter(first) ". " ;counter-increment: first;}ol > ol > li:before {content: counter(first) "." counter(second) ". " ;counter-increment: second;}ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) ". ";counter-increment: third;}ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) ". ";counter-increment: fourth;}ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) ". ";counter-increment: fifth;}ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) ". ";counter-increment: sixth;}ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) ". ";counter-increment: seventh;}ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) ". ";counter-increment: eigth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) ". ";counter-increment: ninth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) ". ";counter-increment: tenth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) ". ";counter-increment: eleventh;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) ". ";counter-increment: twelth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) "." counter(thirteenth) ". ";counter-increment: thirteenth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "." counter(eigth) "." counter(ninth) "." counter(tenth) "." counter(eleventh) "." counter(twelth) "." counter(thirteenth) "." counter(fourteenth) ". ";counter-increment: fourteenth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "."  counter(eigth) "."  counter(ninth) "."  counter(tenth) "."  counter(eleventh) "."  counter(twelth) "."  counter(thirteenth) "."  counter(fourteenth) "." counter(fifteenth) ". ";counter-increment: fifteenth;}ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > li:before {content: counter(first) "." counter(second) "." counter(third) "." counter(fourth) "." counter(fifth) "." counter(sixth) "." counter(seventh) "."  counter(eigth) "."  counter(ninth) "."  counter(tenth) "."  counter(eleventh) "."  counter(twelth) "."  counter(thirteenth) "."  counter(fourteenth) "."  counter(fifteenth) "."  counter(sixthteenth) ". ";counter-increment: sixthteenth;}ol{ text-indent: 0px; }ol > ol{ text-indent: 10px; }ol > ol > ol{ text-indent: 20px; }ol > ol > ol > ol{ text-indent: 30px; }ol > ol > ol > ol > ol{ text-indent: 40px; }ol > ol > ol > ol > ol > ol{ text-indent: 50px; }ol > ol > ol > ol > ol > ol > ol{ text-indent: 60px; }ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 70px; }ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 80px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 90px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 100px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 110px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol { text-indent: 120px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 130px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 140px; }ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol > ol{ text-indent: 150px; }</style>
</head>
<body>NOTES GENERALES<br>---------------<br><br># qlogin sur un noeud<br>qlogin<br><br># qlogin sur un noeud specifique pour retrouver le m&#234;me repertoire tmp<br># (si vous n&#x27;avez pas de repertoire projet)<br>qlogin -q qlogin.q@nXX # avec XX votre numero de noeud precedent<br><br># aller dans votre r&#233;pertoire de travail<br>cdprojet # OU BIEN si vous n&#x27;avez pas de r&#233;pertoire projet:<br>cd &#x2F;tmp<br><br># Les donn&#233;es pr&#233;par&#233;es avant le TP sont dispos ici:<br>ls &#x2F;scratch&#x2F;sbr&#x2F;tags&#x2F;RAD-tags-for-student<br><br># R studio accessible dans le navigateur internet par:<br>r.sb-roscoff.fr<br><br>A FAIRE PAR LES ENSEIGNANTS<br>---------------------------<br><br># Mercredi pour copier les donn&#233;es SNP (utiles dans l&#x27;apr&#232;s-midi seulement)<br># par Gildas (il faut les droits!):<br>cdprojet<br>cd RAD-tags-for-students&#x2F;03-variant-calling<br>cp -rv 10_SNP-results&#x2F; &#x2F;scratch&#x2F;sbr&#x2F;stage&#x2F;RAD-tags-for-students&#x2F;03-variant-calling&#x2F;<br><br>NOTES MARDI APRES-MIDI<br>----------------------<br><br># Creer un repertoire de travail pour la premiere etape<br>mkdir 01-raw-reads<br>cd 01-raw-reads<br><br># Copier les fichiers bruts<br>cp -rv &#x2F;scratch&#x2F;sbr&#x2F;stage&#x2F;RAD-tags-for-students&#x2F;01-raw-reads-processing&#x2F;01_raw_reads&#x2F;* .<br><br># INFO : alternative :&nbsp; Infos sur fichiers FASTQ<br>clc_sequence_info mySeqFile<br><br># grep et compter en m&#234;me temps<br>grep -c &quot;^TCTTCC&quot; s_2_2_sequence.fastq<br><br>NOTES MERCREDI<br>--------------<br><br>grep -c &quot;^@&quot; SKA-rev.fastq # Compte directement le nombre de lignes qui correspondent<br><br># INFO : Pour retrouver les paires de sequences<br>get_pairs.py s_1_1.sequence.fq BYN.rev.fq &amp;&amp; mv s_1_1.sequence.paired.fq BYN.for.paired.fq<br># script maison :)<br><br># Pour dupliquer un flux<br><br><br><br><br># assemblage de novo<br><br>pwd<br>cd ..<br>mkdir 02-de-novo-assembly<br>cd 02-de-novo-assembly&#x2F;<br>cd ..<br>mkdir scripts<br>cd scripts<br>ls<br>cd ..<br><br><br>cd 02-de-novo-assembly<br>cd 03_raw-reads-clean<br>ls<br>mv for.fastq ..<br>mv rev.fastq ..<br>pwd<br># 02-de-novo.....<br><br>python ..&#x2F;scripts&#x2F;split_fasta_qual.py for.fastq<br>python ..&#x2F;scripts&#x2F;split_fasta_qual.py rev.fastq<br><br>head rev.fastq.fasta<br>head rev.fastq.fasta.qual<br><br>qsub -q long.q ..&#x2F;scripts&#x2F;cap3-for-job<br><br># INFO : r&#233;cup&#233;rer son num&#233;ro de job et tuer celui-ci<br>\qstat<br>qdel 13841<br><br># Recuperer l&#x27;assemblage de CAP3<br>cp -rv &#x2F;scratch&#x2F;sbr&#x2F;stage&#x2F;RAD-tags-for-students&#x2F;02-de-novo_assembly&#x2F;05_CAP3_output&#x2F;* .<br><br># Longueurs des consensus<br>python ..&#x2F;scripts&#x2F;get_fasta_length.py cap3-rev.fasta<br><br>INFO : alternative : longueur des sequences<br>infoseq -only -name - length -noheading -sequence cap3-rev.fasta<br><br><br># distribution des longueurs de contigs sous R<br># Sous linux<br>pwd<br><br># Sous R<br>setwd(&#x27;&#x2F;projet...&#x27;)<br>dir() # pour v&#233;rifier la pr&#233;sence des fichiers<br><br># INFO :&nbsp; filter sur les longeurs de s&#233;quence<br>prinseq-lite.pl -fasta cap3-rev.fasta&nbsp; -min_len 68 -max_len 68 -out_good cap3-rev-68.fasta<br><br># Copier le resultat du blastn consensus contre consensus (sequences reverse)<br>cp -rv &#x2F;scratch&#x2F;sbr&#x2F;stage&#x2F;RAD-tags-for-students&#x2F;02-de-novo_assembly&#x2F;06_CAP3_blast&#x2F;* .<br><br>head -n 100 cap3-blastn-results | column -t | less -S<br><br><br># Compter le nombre de sequences consensus<br>grep -c &quot;^&gt;&quot; cap3-rev.fasta<br><br># Compter le nombre de resultats blastn<br>wc -l cap3-blastn-results<br><br><br># INFO : r&#233;cup&#233;rer le nombre de match pleine longueur hors r&#233;ciproque<br>awk &#x27;$1 != $2 &amp;&amp; $4 == 68&#x27; cap3-blastn-results | wc -l<br><br># INFO : piste pour filtrer des fasta grace &#224; leurs indentifiants. A vous de compl&#233;ter, j&#x27;ai la flemme<br>cut # sur les r&#233;sultats de sputnik<br>fasta2tab # transformer votre fasta de contig en fichier tabul&#233;<br>join # filtre les lignes du &quot;fasta&quot; en fonction des identifiants trouv&#233; par sputnik<br>tab2fasta # retour au fasta<br><br><br># Detection de variants<br><br>cd ..<br>mkdir 03-variant-calling<br>cd 03-variant-calling<br><br>cp &#x2F;scratch&#x2F;sbr&#x2F;stage&#x2F;RAD-tags-for-students&#x2F;01-raw-reads-processing&#x2F;01_raw_reads&#x2F;s_6_1_sequence.fastq .<br>cp ..&#x2F;scripts&#x2F;extract_phred_profiles.py .<br><br>head -n 100 s_6_1_sequence.fastq.phred-profiles | column -t | less -S<br><br><ul class="indent"><li><br></li><li># INFO : alternative : rapport qualit&#233; sous forme de fichier HTML &#224; ouvrir sous Firefox</li></ul>fastqc *.fastq<br><br><br>cp &#x2F;scratch&#x2F;sbr&#x2F;stage&#x2F;RAD-tags-for-students&#x2F;01-raw-reads-processing&#x2F;03_raw-reads-clean&#x2F;* .<br>python ..&#x2F;scripts&#x2F;trim_reads.py *.fastq.clean 20 40<br><br><br>scp -r n68:&#x2F;tmp&#x2F;10_SNP-results .<br><br># R<br>setwd(&quot;10_SNP-results&quot;)<br><br><br><br><br><br># NOTES JEUDI<br>#------------<br><br># Se connecter en qlogin comme d&#x27;habitude<br>qlogin<br>cdprojet # OU BIEN<br>cd &#x2F;tmp&#x2F;<br><br># Retourner dans 03-variant-calling<br><br>less for.pileup<br><br><br><br><br># Creer un repertoire pour la localisation des marqueurs<br>cd ..<br>ls<br><br><br># T&#233;l&#233;charger les donn&#233;es<br>scp -r n68:&#x2F;tmp&#x2F;04-mapping-3spine .<br>ls<br>cd 04-mapping-3spine<br>&nbsp;<br>cd 01-blast&#x2F;Ga_Ensembl_fasta<br>q<br>wc -l names.dna<br>less names.dna<br>head names.dna<br>tail names.dna<br>grep &quot;group&quot; names.dna<br><br>cd ..<br><br>wc -l blastn-vs-3spine-dna<br>wc -l consensus-*<br>grep -c &quot;&gt;&quot; consensus-for.fasta<br>grep -c &quot;&gt;&quot; consensus-rev.fasta<br><br>head -n 100 blastn-vs-3spine-dna | column -t | less -S<br><br>cd results<br><br>column -t blastn-vs-3spine-dna.bestHits | less -S<br><br>pwd<br><br><br># dans R<br>setwd(&quot;.......&quot;)<br>dir()<br># &quot;blastn-vs-3spine-dna.bestHits&quot;<br><br><br># Script live<br><br>plot(density(d$blastndeltaLogBestEvalues, na.rm = T))<br>cns_vld = subset(d, d$blastndeltaLogBestEvalues &gt;= 5)<br>compteParChr = table(cns_vld$blastnsseqid)<br><br>setwd(&quot;..&quot;)<br>lengths = read.table(&quot;chromosomeLengths&quot;, sep = &quot;\t&quot;, header = T)<br><br># Garder seulement les donn&#233;es pour les chromosomes<br>compteParChr = as.data.frame(compteParChr)<br>i = grepl(&quot;group&quot;, compteParChr[, 1])<br>compteParChr = compteParChr[i, ]<br>compteParChr<br><br>lengths = lengths[, c(2,4)]<br>i = grepl(&quot;group&quot;, lengths[, 1])<br>lengths = lengths[i, ]<br><br># Fusionne les tableaux<br>compteParChr[, 1] = as.character(compteParChr[, 1])<br>lengths[, 1] = as.character(lengths[, 1])<br>names(compteParChr) = c(&quot;name&quot;, &quot;compte&quot;)<br>tab = merge(lengths, compteParChr, by = &quot;name&quot;)<br><br><br>plot(tab$length, tab$compte, pch = 21, bg = &quot;cornflowerblue&quot;)<br>text(tab$length, tab$compte, labels = tab$name)<br><br><br><br># Kernel smoothing<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></body>
</html>
